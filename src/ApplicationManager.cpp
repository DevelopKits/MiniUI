#include "ApplicationManager.h"

#include "Applications/ImageViewer.h"
#include "Applications/PhoneBook.h"
#include "Applications/MainMenu.h"

using namespace Applications;
using namespace MiniUI;

///////////////////////////////////////////////////////////////////////////////
ApplicationManager::ApplicationManager ( )
///////////////////////////////////////////////////////////////////////////////
{
	_selectedApp = NULL;
}

///////////////////////////////////////////////////////////////////////////////
ApplicationManager::~ApplicationManager ( )
///////////////////////////////////////////////////////////////////////////////
{
	ApplicationMap::iterator i;
	for ( i = _applications.begin(); i != _applications.end(); i++ )
		delete i->second;
}

///////////////////////////////////////////////////////////////////////////////
void ApplicationManager::Initialize ( )
///////////////////////////////////////////////////////////////////////////////
{
	AddApplication ( new MainMenu ( UIManager::Instance() ) );
	AddApplication ( new ImageViewer ( UIManager::Instance() ) );
	AddApplication ( new PhoneBook ( UIManager::Instance() ) );
}

///////////////////////////////////////////////////////////////////////////////
void ApplicationManager::AddApplication ( Applications::IApplication *pApp )
///////////////////////////////////////////////////////////////////////////////
{
	_applications[pApp->ScreenName()] = pApp;
}

///////////////////////////////////////////////////////////////////////////////
bool ApplicationManager::ShowScreen ( std::string id )
///////////////////////////////////////////////////////////////////////////////
{
	if ( _selectedApp )
		_selectedApp->Hide();
	
	ApplicationMap::const_iterator i = _applications.find ( id );
	if ( i == _applications.end() )
		return false;

	_selectedApp = i->second;
	i->second->Show ( );
	
	return true;
}
